# ⚙️ SchedLab — 智能进程调度算法实验与优化平台

[English](./README.en.md) | **中文**

[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](./LICENSE)
[![Vue](https://img.shields.io/badge/Vue-3.x-42b883?logo=vuedotjs)](https://vuejs.org/)
[![Rust](https://img.shields.io/badge/Rust-1.70+-orange.svg?logo=rust)](https://www.rust-lang.org/)
[![WebAssembly](https://img.shields.io/badge/WASM-Ready-654FF0?logo=webassembly)](https://webassembly.org/)
[![Vite](https://img.shields.io/badge/Vite-8.x-646cff?logo=vite)](https://vitejs.dev/)

---

## 项目简介

**SchedLab** 是一个高性能的**进程调度算法可视化与实验平台**。本项目旨在解决传统调度算法演示工具性能瓶颈、功能单一、缺乏深度分析的问题。

通过采用 **Rust + WebAssembly (WASM)** 作为高性能调度核心，结合 **Vue 3** 构建现代可视化界面，SchedLab 不仅能流畅模拟海量进程的并发调度，还引入了**负载特征智能分析**、**算法推荐引擎**和**可插拔算法架构**，为操作系统调度策略的研究、对比与优化提供了一个直观且强大的实验环境。

---

## 功能特性

### 📋 核心调度模拟

- **进程控制模拟**：完整的 PCB（进程控制块）数据结构，包含进程名、优先级、到达时间、所需 CPU 时间、已用 CPU 时间、当前状态
- **四状态转换**：执行 `E(Execute)` / 就绪 `R(Ready)` / 等待 `W(Wait)` / 完成 `F(Finish)` 状态机可视化
- **基于优先级的时间片轮转 (Priority RR)**：
  - 支持自定义进程数、到达时间、运行时间、初始优先级（1~100，值越小优先级越高）
  - 可自定义时间片大小，进程每执行一个时间片后优先级动态降低（+2 / +3 可配置）
  - 高优先级进程抢占：被唤醒进程优先级高于当前执行进程时立即剥夺 CPU
- **多级反馈队列 (MLFQ)**：
  - 三级队列，时间片大小按队列编号依次加倍
  - 进程降级机制：用完当前队列时间片后降至下一级队列
- **动态可视化**：每个调度时刻展示甘特图、各队列排队状态、每个进程的剩余时间和当前状态
- **性能统计**：各进程开始时间、结束时间、周转时间，计算平均周转时间
- **算法横向对比**：相同进程集合一键切换两种算法，对比性能指标差异

### 🚀 增强与分析功能

- **高性能 WASM 引擎**：Rust 编写的调度核心，支持大规模进程集合的极速仿真与参数扫描
- **负载特征识别**：自动分析进程集合属于 CPU 密集型、I/O 密集型还是混合型负载
- **规则推荐引擎**：基于负载特征与进程分布特点，给出算法选择建议及量化预估
  > *示例："检测到短作业占比 78%，推荐 Priority RR（小时间片），预计平均周转时间优于 MLFQ 约 20%"*
- **可插拔算法接口**：预留标准化调度器接口，便于后续扩展 SJF、CFS 等自定义算法
- **参数实验模式**：固定进程集，批量测试不同时间片大小对性能的影响并可视化

---

## 技术架构

```
┌─────────────────────────────────────────────────────────┐
│                   Vue 3 + Vite  界面层                   │
│  ┌──────────────┐  ┌──────────────┐  ┌───────────────┐  │
│  │  进程编辑器   │  │  甘特图组件   │  │  性能对比面板  │  │
│  │ ProcessEditor│  │ GanttChart   │  │ StatsPanel    │  │
│  └──────────────┘  └──────────────┘  └───────────────┘  │
│  ┌──────────────┐  ┌──────────────┐  ┌───────────────┐  │
│  │  队列状态图   │  │  PCB 状态机   │  │ 推荐引擎面板   │  │
│  │ QueueView    │  │PCBStateMachine│  │ AdvisorPanel  │  │
│  └──────────────┘  └──────────────┘  └───────────────┘  │
└─────────────────────────────────────────────────────────┘
                          ↓  WASM 绑定 (wasm-bindgen)
┌─────────────────────────────────────────────────────────┐
│              调度核心层 (Rust + WebAssembly)              │
│  ┌─────────────────────────────────────────────────┐    │
│  │          统一调度器接口 (Scheduler Trait)         │    │
│  │  ┌──────────┐  ┌──────────┐  ┌───────────────┐  │    │
│  │  │Priority  │  │  MLFQ   │  │  可扩展插槽    │  │    │
│  │  │   RR     │  │(3队列)  │  │ (SJF/CFS/...) │  │    │
│  │  └──────────┘  └──────────┘  └───────────────┘  │    │
│  └─────────────────────────────────────────────────┘    │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────────┐  │
│  │  PCB 管理   │  │  负载分析器  │  │  统计计算器     │  │
│  └─────────────┘  └─────────────┘  └─────────────────┘  │
└─────────────────────────────────────────────────────────┘
                          ↓
┌─────────────────────────────────────────────────────────┐
│                     测试负载层                           │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────────┐  │
│  │  内置预设   │  │  手动输入   │  │  随机负载生成   │  │
│  │  (多种场景) │  │  (自定义)   │  │  (负载类型可选) │  │
│  └─────────────┘  └─────────────┘  └─────────────────┘  │
└─────────────────────────────────────────────────────────┘
```

### 技术栈

| 层级 | 技术选型 | 说明 |
|------|---------|------|
| 前端框架 | Vue 3 + `<script setup>` | Composition API，响应式驱动调度动画 |
| 构建工具 | Vite 8 + wasm-pack | 极速 HMR，自动编译 Rust 为 WASM |
| 状态管理 | Pinia | 跨组件共享调度状态与历史记录 |
| 可视化 | Canvas / SVG | 甘特图、队列动画 |
| 调度核心 | Rust + WebAssembly | 内存安全，极速仿真，无服务端依赖 |

---

## 调度算法说明

| 算法 | 简称 | 队列数 | 时间片策略 | 抢占 | 状态 |
|------|------|--------|-----------|------|------|
| 基于优先级的时间片轮转 | Priority RR | 1 | 固定，可配置；执行后优先级降低 | ✅ 优先级抢占 | ✅ 内置 |
| 多级反馈队列 | MLFQ | 3 | Q1:q, Q2:2q, Q3:4q（q 可配置） | ✅ 队列间抢占 | ✅ 内置 |
| 短作业优先（扩展） | SJF | 1 | 不适用 | ❌ 非抢占 | 🔌 插件预留 |
| 完全公平调度（扩展） | CFS | 1 | 动态（虚拟运行时间） | ✅ | 🔌 插件预留 |

---

## 快速开始

### 前置要求

- Node.js ≥ 18
- pnpm ≥ 9（`npm install -g pnpm`）
- Rust 工具链（`rustup`, `cargo`）
- wasm-pack（`cargo install wasm-pack`）

### 安装与运行

```bash
# 克隆项目
git clone https://github.com/Owl23007/proc-sched-lab.git
cd proc-sched-lab

# 编译 Rust 核心为 WASM
cd core
wasm-pack build --target web

# 返回前端目录并安装依赖
cd ../
pnpm install

# 启动开发服务器
pnpm dev
```

浏览器访问 `http://localhost:5173` 即可使用。

---

## 计划目录结构

```
proc-sched-lab/
├── core/                     # Rust WASM 核心
│   ├── Cargo.toml
│   └── src/
│       ├── lib.rs            # WASM 导出接口
│       ├── pcb.rs            # PCB 数据结构
│       ├── schedulers/       # 调度算法实现 (Priority RR, MLFQ)
│       └── analyzer.rs       # 负载分析与统计
│
├── src/                      # Vue 前端
│   ├── main.js               # 应用入口
│   ├── App.vue               # 根组件
│   ├── wasm/                 # WASM 绑定封装层
│   ├── stores/               # Pinia 状态管理
│   ├── components/           # UI 组件 (GanttChart, QueueView 等)
│   └── utils/                # 辅助工具
│
├── package.json
└── vite.config.js
```

---

## 开发路线图

请参阅 [todo.md](./todo.md) 查看详细的开发计划与进度。

---

## 贡献说明

欢迎提交 Issue 和 Pull Request。代码遵循 MIT 协议，二次开发、修改和商业使用均被允许，但需在衍生作品中保留原始版权声明。

---

## 许可证

Copyright © 2026 [Owl23007](https://github.com/Owl23007)

本项目基于 [MIT License](./LICENSE) 开源。
